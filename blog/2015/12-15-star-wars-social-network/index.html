
<!doctype html>
<!--[if IE 9]><html class="lt-ie10" lang="en" > <![endif]-->
<html class="no-js" lang="en" data-useragent="Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>The Star Wars social network</title>
    <meta name="description" content="" />
    <meta name="author" content="Evelina Gabasova" />
    <meta name="copyright" content="Evelina Gabasova 2014" />

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@evelgab">
    <meta name="twitter:title" content="The Star Wars social network">
    <meta name="twitter:description" content="">
    <!-- End Twitter cards -->

    <link rel="stylesheet" href="http://evelinag.com/stylesheets/foundation.min.css">
    <link rel="stylesheet" href="http://evelinag.com/stylesheets/fontsStylesheet.css">
    <link rel="stylesheet" href="http://evelinag.com/stylesheets/personalStyles.css">
    <link rel="stylesheet" href="http://evelinag.com/stylesheets/pygment_trac.css">

    <link rel="shortcut icon" href="http://evelinag.com/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="alternate" type="application/rss+xml" title="Evelina Gabasova's blog" href="http://evelinag.com/rss.xml" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- FSharp.Formatting Styles -->
    <link rel="stylesheet" type="text/css" media="screen" href="http://evelinag.com/fsharp.formatting/tooltips.css" />
    <script type="text/javascript" src="http://evelinag.com/fsharp.formatting/tooltips.js"></script>
    <script type="text/javascript" src="http://evelinag.com/javascripts/modernizr.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <!-- Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-50895981-1', 'evelinag.com');
        ga('send', 'pageview');

    </script>
    <!-- End Google Analytics -->
</head>


<body>
    <!-- Nav Bar -->
    <div class="row">
        <div class="medium-12 columns">

            <div class="logo">
                <a href="http://www.evelinag.com"><h1>Evelina Gabasova<apostrophe>'</apostrophe>s blog</h1></a>
            </div>

        </div>
    </div>
    <!-- End Nav -->
    <!-- Main Page Content and Sidebar -->
    <div class="row">
        <div class="large-10 medium-12 small-12 columns" role="content">
            
<h1>The Star Wars social network</h1>
<article>
    
<div class="row">
<div class="medium-7 columns">

<p>Some of us are looking forward to Christmas, and some of us are looking forward to the
new film in the Star Wars franchise, The Force Awakens. Meanwhile, I decided to look at the
whole 6-movie cycle from a quantitative point of view and extract the Star Wars social networks, 
both within each film and across the whole Star Wars universe. 
Looking at the social network structure reveals some surprising differences between the
original trilogy and the prequels.</p>

</div>
<div class="medium-5 columns">

<p><img src="http://evelinag.com/blog/2015/12-15-star-wars-social-network/star-wars-logo.png" alt="Star Wars logo" /></p>

</div>
</div>

<!-- more -->

<p>If you're interested in technical details of how I extracted the data, head down 
to the <a href="#how">How I did the analysis</a> section. But let's start with some visualizations.</p>

<p>This is the social network from all the 6 movies combined together:</p>

<p><img src="starwars.png" alt="Star Wars social network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/interactions.html">Open network</a></p>

<p>You can open the network in a full window which will show an interactive visualization of the network
where you can drag individual nodes around. If you hover over the individual nodes, you'll see
the name of the corresponding character.</p>

<p>Here the nodes represent characters in the movies. The characters are connected by a link if 
they both speak in the same scene. And the more the characters speak together, the 
thicker the link between them. The size of each node corresponds to the total number of scenes
the character appears in. I made a few arguable decisions though: Anakin and Darth Vader
are represented by two separate nodes, because this distinction is important to the story. 
On the other hand, the Emperor node also jointly represents Palpatine and Darth Sidious. I also
merged Amidala with Padme.</p>

<p>The original trilogy (episodes IV, V and VI) on the right is mostly separated in the network from 
the prequel trilogy on the left because most characters appear only in one of the trilogies. 
The crucial nodes that are connecting the two networks
are Obi-Wan Kenobi, R2-D2 and C-3PO. Especially the robots seem to play an important social function
because they appear frequently across all the movies. 
The structures of the two sub-networks are also different. s
The original trilogy has fewer important nodes (Luke, Han, Leia,
Chewbacca, Darth Vader) and they are densely interconnected between themselves. The prequel trilogy
has more nodes overall, with many more connections. 
I'll look at individual films in more detail later in the post.</p>

<h2>Character timelines</h2>

<p>Many of the characters feature in multiple movies, so I also created a comparison of their 
timelines across the individual episodes. The following graphics shows where the individual 
characters are mentioned in the film scripts. In order of appearance, these are the timelines
of some of the main characters:</p>

<p><img src="timelines.png" alt="timelines" /></p>

<p>Here I included all mentions of each character, which includes other characters discussing 
their name. It is interesting to see how Anakin appears simultaneously with Darth Vader during Episode III, 
and then Darth Vader takes over. Anakin again reappears towards the end of Episode VI when 
Darth Vader turns away from the Dark side.</p>

<p>The characters that appear most consistently across all the films are the same ones that are
in the centre of the social network - Obi-Wan, C-3PO and R2-D2. Yoda and the Emperor also appear
across all of the films but they don't talk directly with many people in the original trilogy, which moves
them off the centre in the social network.</p>

<h2>Networks in individual films</h2>

<p>Now let's look at the networks in individual films. Notice how the number of nodes and
 complexity of the networks change between the prequels and the original movies. Again, a link
 appears between characters if they speak within the same scene.</p>

<div class="row">
<div class="medium-6 columns">

<h4>Episode I: The Phantom Menace</h4>

<p><img src="episode1.png" alt="Episode 1 network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/episode1-interactions.html">Open network</a></p>

</div>
<div class="medium-6 columns">

<h4>Episode II: Attack of the Clones</h4>

<p><img src="episode2.png" alt="Episode 2 network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/episode2-interactions.html">Open network</a></p>

</div>
</div>
<div class="row">
<div class="medium-6 columns">

<h4>Episode III: Revenge of the Sith</h4>

<p><img src="episode3.png" alt="Episode 3 network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/episode3-interactions.html">Open network</a></p>

</div>
<div class="medium-6 columns">

<h4>Episode IV: A New Hope</h4>

<p><img src="episode4.png" alt="Episode 4 network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/episode4-interactions.html">Open network</a></p>

</div>
</div>
<div class="row">
<div class="medium-6 columns">

<h4>Episode V: The Empire Strikes Back</h4>

<p><img src="episode5.png" alt="Episode 5 network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/episode5-interactions.html">Open network</a></p>

</div>
<div class="medium-6 columns">

<h4>Episode VI: Return of the Jedi</h4>

<p><img src="episode6.png" alt="Episode 6 network" />
<a href="https://s3-eu-west-1.amazonaws.com/evelinag/star-wars/episode6-interactions.html">Open network</a></p>

</div>
</div>

<h3>Importance of characters</h3>

<p>The individual networks again show that the prequel trilogy has more characters and more interactions
overall. The original episodes have less characters, but they interact more with each other.</p>

<p>George Lucas said:</p>

<blockquote>
  <p>It really is the story of the tragedy of Darth Vader, 
and it starts when he's nine, and it ends when he's dead.
<a href="http://www.theguardian.com/commentisfree/2015/dec/14/myth-star-wars-force-awakens-heroic-legends">(source)</a></p>
</blockquote>

<p>But is Darth Vader/Anakin really the central character? Let's use some methods from network analysis to
see who is really important in the stories and their social structures. 
I computed two measures of importance in the networks for each of
the films:</p>

<ul>
<li><p><em>Degree centrality</em> - this is simply the number of connections the node has in the network. 
In the Star Wars movies, this corresponds to the total number of scenes where each character
speaks.</p></li>
<li><p><em>Betweenness</em> - this measure looks at how many shortest paths in the network lead through the node. 
For example, imagine you are Leia and you want to send a message to Greedo - the shortest
path how to send it is via Han Solo, because he interacted both with Leia and with Greedo. On
the other hand if you want to send a message to Luke, you don't have to go through Han
because Leia knows Luke directly.
The betweenness centrality
for Han is computed using the number of shortest paths between all other characters that pass through him.</p></li>
</ul>

<p>The two measures both show how important is a character in the network. The degree centrality shows how
many people does each character interact with directly. 
The betweenness relates more to how integral each of the characters is to 
the story. Characters with high betweenness connect different areas of the social network.</p>

<p>For both measures, higher values mean more importance.
Here are the top 5 characters for each movie:</p>

<div class="row">
<div class="medium-4 columns">

<h4>Episode I</h4>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>QUI-GON</p></td>
<td><p>26</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>ANAKIN</p></td>
<td><p>23</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>JAR JAR</p></td>
<td><p>19</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>R2-D2</p></td>
<td><p>19</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>PADME</p></td>
<td><p>18</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>QUI-GON</p></td>
<td><p>91.7</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>JAR JAR</p></td>
<td><p>46.6</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>EMPEROR</p></td>
<td><p>41.8</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>R2-D2</p></td>
<td><p>30.9</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>NUTE GUNRAY</p></td>
<td><p>27.2</p></td>
</tr>
</tbody>
</table>


</div>
<div class="medium-4 columns">

<h4>Episode II</h4>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>ANAKIN</p></td>
<td><p>21</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>19</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>PADME</p></td>
<td><p>17</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>YODA</p></td>
<td><p>10</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>MACE WINDU</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>64.7</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>PADME</p></td>
<td><p>56.5</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>MACE WINDU</p></td>
<td><p>12.7</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>JAR JAR</p></td>
<td><p>8.3</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>EMPEROR</p></td>
<td><p>6.8</p></td>
</tr>
</tbody>
</table>


</div>
<div class="medium-4 columns">

<h4>Episode III</h4>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>ANAKIN</p></td>
<td><p>14</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>13</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>BAIL ORGANA</p></td>
<td><p>12</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>EMPEROR</p></td>
<td><p>11</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>PADME</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>22.7</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>EMPEROR</p></td>
<td><p>19.0</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>PADME</p></td>
<td><p>8.0</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>R2-D2</p></td>
<td><p>6.7</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>BAIL ORGANA</p></td>
<td><p>4.5</p></td>
</tr>
</tbody>
</table>


</div>
</div>

<p>It seems that Anakin is overall the most connected character in the first three films, based on 
his degree. He is however not very integral to the relations in the films! His betweenness score
is so small he never makes it to the top-5 characters. This means that all the other characters
interact directly between themselves rather than through Anakin. How do the same measures look 
for the original trilogy?</p>

<div class="row">
<div class="medium-4 columns">

<h4>Episode IV</h4>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>LUKE</p></td>
<td><p>15</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>LEIA</p></td>
<td><p>12</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>C-3PO</p></td>
<td><p>10</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>CHEWBACCA</p></td>
<td><p>9</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>HAN</p></td>
<td><p>8</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>LUKE</p></td>
<td><p>32.7</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>LEIA</p></td>
<td><p>19.7</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>HAN</p></td>
<td><p>15.0</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>C-3PO</p></td>
<td><p>13.2</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>CHEWBACCA</p></td>
<td><p>8.0</p></td>
</tr>
</tbody>
</table>


</div>
<div class="medium-4 columns">

<h4>Episode V</h4>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>LUKE</p></td>
<td><p>12</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>DARTH VADER</p></td>
<td><p>12</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>HAN</p></td>
<td><p>11</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>R2-D2</p></td>
<td><p>11</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>C-3PO</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>LUKE</p></td>
<td><p>25.2</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>DARTH VADER</p></td>
<td><p>11.3</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>LEIA</p></td>
<td><p>9.7</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>HAN</p></td>
<td><p>6.7</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>R2-D2</p></td>
<td><p>4.5</p></td>
</tr>
</tbody>
</table>


</div>
<div class="medium-4 columns">

<h4>Episode VI</h4>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>LUKE</p></td>
<td><p>15</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>R2-D2</p></td>
<td><p>12</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>C-3PO</p></td>
<td><p>11</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>LEIA</p></td>
<td><p>9</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>HAN</p></td>
<td><p>9</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>LUKE</p></td>
<td><p>24.3</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>C-3PO</p></td>
<td><p>23.0</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>DARTH VADER</p></td>
<td><p>18.5</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>CHEWBACCA</p></td>
<td><p>16.0</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>LANDO</p></td>
<td><p>5.5</p></td>
</tr>
</tbody>
</table>


</div>
</div>

<p>Here both the centrality measures show very similar results - Luke is the most central character
across all the films, and using both measures. The order of characters based on the two measures
is almost the same.</p>

<p>The centrality analysis quantifies some of the things we could see from the social networks. The prequel
trilogy has more complex social structures, with more interconnected characters. This also leads to the 
fact that Anakin is not that central to the story - some of the storylines happen alongside Anakin's story,
or involve Anakin only on the side. On the other hand, the original trilogy has a more tight-knit structure. 
There is a smaller number of central characters and they bind the story together - this results into the
agreement between the degree and betweenness centrality measures.</p>

<p>Perhaps this is part of the reason why the original trilogy is more popular - the plots
are more consistent and driven by the main characters. The prequels have a more decentralized structure
and no clear hero. Although the stories are linked by Anakin, he is not binding the other characters
together.</p>

<p>How do the measures look when we look at the full social network from all the episodes together? I looked
at two variants of the network. In the first one Anakin and Darth Vader appear as two separate individuals,
in the second I merged them together into a single person.</p>

<div class="row">
<div class="medium-6 columns">

<h4>Joint network 1</h4>

<p>Anakin and Darth Vader separated</p>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>ANAKIN</p></td>
<td><p>42</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>R2-D2</p></td>
<td><p>41</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>37</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>PADME</p></td>
<td><p>34</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>C-3PO</p></td>
<td><p>31</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>370.4</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>PADME</p></td>
<td><p>237.3</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>R2-D2</p></td>
<td><p>236.7</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>C-3PO</p></td>
<td><p>222.9</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>LUKE</p></td>
<td><p>194.4</p></td>
</tr>
</tbody>
</table>


</div>
<div class="medium-6 columns">

<h4>Joint network 2</h4>

<p>Anakin and Darth Vader fused</p>

<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Degree</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>DARTH VADER</p></td>
<td><p>59</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>R2-D2</p></td>
<td><p>41</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>37</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>PADME</p></td>
<td><p>34</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>C-3PO</p></td>
<td><p>31</p></td>
</tr>
</tbody>
</table>


<table>
<thead>
<tr class="header">
<th></th>
<th><p>Name</p></th>
<th><p>Betweenness</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1.</p></td>
<td><p>OBI-WAN</p></td>
<td><p>348.7</p></td>
</tr>
<tr class="even">
<td><p>2.</p></td>
<td><p>C-3PO</p></td>
<td><p>303.1</p></td>
</tr>
<tr class="odd">
<td><p>3.</p></td>
<td><p>DARTH VADER</p></td>
<td><p>241.5</p></td>
</tr>
<tr class="even">
<td><p>4.</p></td>
<td><p>R2-D2</p></td>
<td><p>227.6</p></td>
</tr>
<tr class="odd">
<td><p>5.</p></td>
<td><p>PADME</p></td>
<td><p>226.2</p></td>
</tr>
</tbody>
</table>


</div>
</div>

<p>If we look at Anakin and Darth Vader separately, Anakin is still the most connected character but
he's not central to the network. If we merge them together, things improve a bit. Now Darth Vader/Anakin
is the third most important character in terms of betweenness. Overall, the social networks seem to show
that the Star Wars movies are actually linked together by Obi-Wan Kenobi rather than Darth Vader.</p>

<p>
<img src="star-wars-obi-vs-darth.jpg" width="70%"></img>
</p>

<hr />

<h1 id="how">How I did the analysis</h1>

<p>As this is part of the <a href="https://sergeytihon.wordpress.com/2015/10/25/f-advent-calendar-in-english-2015/">F# Advent calendar</a>,
I used <a href="http://fsharp.org/">F#</a> for most of the analysis. I combined it together with <a href="http://d3js.org/">D3.js</a> for
the social network visualizations, and with <a href="https://www.r-project.org/">R</a> for the network centrality analysis. 
You can find all the source code <a href="https://github.com/evelinag/StarWars-social-network">on my GitHub</a>. Because
the whole code turned out to be relatively long, here I look only at some of the more interesting
parts.</p>

<h2>Parsing the screenplays</h2>

<p>I started by downloading all the scripts for the 6 Star Wars movies. They are freely available from 
<a href="http://www.imsdb.com/">The Internet Movie Script Database (IMSDb)</a>, for example <a href="http://www.imsdb.com/scripts/Star-Wars-A-New-Hope.html">here's the script for
Episode IV: The New Hope</a>. The screenplays are only
in the form of drafts that sometimes differ from the actual films - the differences are
however not very big.</p>

<p>The first step was to parse the screenplays. 
To complicate things, each of
them used a slightly different format. The screenplays themselves were in HTML, either within the 
<code>&lt;td class="srctext"&gt;&lt;/td&gt;</code> tags, or within the <code>&lt;pre&gt;&lt;/pre&gt;</code> tags. 
To extract the contents of each script, 
I used the <a href="http://fsharp.github.io/FSharp.Data/library/HtmlParser.html">Html Parser from F# Data library</a>
which allows accessing individual tags in a HTML document using statements like</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">Data</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">url</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">http</span><span class="s">:</span><span class="s">/</span><span class="s">/</span><span class="s">www</span><span class="s">.</span><span class="s">imsdb</span><span class="s">.</span><span class="s">com</span><span class="s">/</span><span class="s">scripts</span><span class="s">/</span><span class="s">Star</span><span class="s">-</span><span class="s">Wars</span><span class="s">-</span><span class="s">A</span><span class="s">-</span><span class="s">New</span><span class="s">-</span><span class="s">Hope</span><span class="s">.</span><span class="s">html</span><span class="s">&quot;</span>
<span class="i">HtmlDocument</span><span class="o">.</span><span class="i">Load</span>(<span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="i">url</span>)<span class="o">.</span><span class="i">Descendants</span>(<span class="s">&quot;</span><span class="s">pre</span><span class="s">&quot;</span>)</pre>
</td>
</tr>
</table>

<p>The full code for this part is available in the <a href="https://github.com/evelinag/StarWars-social-network/blob/master/parseScripts.fs">parseScripts.fs file</a>.</p>

<p>The next step was to extract relevant information from the scripts. 
In general, a script looks like this:</p>

<pre lang="txt">INT. GANTRY - OUTSIDE CONTROL ROOM - REACTOR SHAFT

Luke moves along the railing and up to the control room.

[...]
                LUKE
        He told me enough!  It was you 
        who killed him.

                VADER
        No.  I am your father.

    Shocked, Luke looks at Vader in utter disbelief.

                LUKE
        No.  No.  That&#39;s not true!  
        That&#39;s impossible!</pre>

<p>Each scene starts with its setting: <code>INT.</code> (interior) or <code>EXT.</code> (exterior) and the location of the scene. 
Then there can be some free text describing what is happening and how does the 
scene look. In the dialogues, the names of characters are written
in capital letters (sometimes also in bold), followed by what they are saying.</p>

<p>The main signposts in the screenplay are the <code>INT.</code> and <code>EXT.</code> statements which 
serve as scene separators. These were written 
consistently in bold in all the 6 scripts and I used them to split them into
individual scenes:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// split the script by scene</span>
<span class="c">// each scene starts with either INT. or EXT. </span>
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="i">splitByScene</span> (<span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">script</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">string</span>[]) <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">scenes</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">scenePattern</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">b</span><span class="s">&gt;</span><span class="s">[</span><span class="s"> </span><span class="s">0</span><span class="s">-</span><span class="s">9</span><span class="s">]</span><span class="s">*</span><span class="s">(</span><span class="s">INT</span><span class="s">.</span><span class="s">|</span><span class="s">EXT</span><span class="s">.</span><span class="s">)</span><span class="s">&quot;</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="i">idx</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="i">script</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="i">tryFindIndex</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">line</span> <span class="k">-&gt;</span> <span class="i">Regex</span><span class="o">.</span><span class="i">Match</span>(<span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="i">line</span>, <span onmouseout="hideTip(event, 'fs7', 15)" onmouseover="showTip(event, 'fs7', 15)" class="i">scenePattern</span>)<span class="o">.</span><span class="i">Success</span>)
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs8', 16)" onmouseover="showTip(event, 'fs8', 16)" class="i">idx</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="i">Some</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="i">i</span> <span class="k">-&gt;</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="i">remainingScenes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 20)" onmouseover="showTip(event, 'fs4', 20)" class="i">script</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs13', 21)" onmouseover="showTip(event, 'fs13', 21)" class="i">i</span><span class="o">+</span><span class="n">1</span> <span class="o">..</span>]
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 22)" onmouseover="showTip(event, 'fs15', 22)" class="i">currentScene</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 23)" onmouseover="showTip(event, 'fs4', 23)" class="i">script</span><span class="o">.</span>[<span class="n">0..</span><span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="i">i</span><span class="o">-</span><span class="n">1</span>]
        <span onmouseout="hideTip(event, 'fs3', 25)" onmouseover="showTip(event, 'fs3', 25)" class="i">splitByScene</span> <span onmouseout="hideTip(event, 'fs14', 26)" onmouseover="showTip(event, 'fs14', 26)" class="i">remainingScenes</span> (<span onmouseout="hideTip(event, 'fs15', 27)" onmouseover="showTip(event, 'fs15', 27)" class="i">currentScene</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs6', 28)" onmouseover="showTip(event, 'fs6', 28)" class="i">scenes</span>)
    | <span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="i">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs4', 30)" onmouseover="showTip(event, 'fs4', 30)" class="i">script</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs6', 31)" onmouseover="showTip(event, 'fs6', 31)" class="i">scenes</span> </pre>
</td>
</tr>
</table>

<p>This is a recursive function that takes the full screenplay and looks for the 
specific pattern, which is <code>EXT.</code> or <code>INT.</code>  in bold, optionally preceded by a scene number. 
The function goes through the string and when it
encounters the scene break, it splits the string into the current scene and the remaining text. Then it
runs recursively until all the scenes are extracted, using the <code>scenes</code> variable as an accumulator.</p>

<h2>Getting list of characters</h2>

<p>The previous function gave me a list of scenes for each of the movies. Extracting the characters 
out of them turned out to be more difficult. 
Some of the scenes followed the format that I showed in the example above, some of the
scenes only used character names followed by a colon and their dialogue, 
all within the same line in the text. The only common property between the different
formats was that the names were always written in capital letters.</p>

<p>I resorted to regular expressions, one for each screenplay format:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Extract names of characters that speak in scenes. </span>
<span class="c">// A) Extract names of characters in the format &quot;[name]:&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 32)" onmouseover="showTip(event, 'fs17', 32)" class="i">getFormat1Names</span> <span onmouseout="hideTip(event, 'fs18', 33)" onmouseover="showTip(event, 'fs18', 33)" class="i">text</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 34)" onmouseover="showTip(event, 'fs19', 34)" class="i">matches</span> <span class="o">=</span> <span class="i">Regex</span><span class="o">.</span><span class="i">Matches</span>(<span onmouseout="hideTip(event, 'fs18', 35)" onmouseover="showTip(event, 'fs18', 35)" class="i">text</span>, <span class="s">&quot;</span><span class="s">[</span><span class="s">/</span><span class="s">A</span><span class="s">-</span><span class="s">Z0</span><span class="s">-</span><span class="s">9</span><span class="s"> </span><span class="s">-</span><span class="s">]</span><span class="s">+</span><span class="s"> </span><span class="s">*</span><span class="s">:</span><span class="s">&quot;</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 36)" onmouseover="showTip(event, 'fs20', 36)" class="i">names</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs21', 37)" onmouseover="showTip(event, 'fs21', 37)" class="i">seq</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs22', 38)" onmouseover="showTip(event, 'fs22', 38)" class="i">m</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs19', 39)" onmouseover="showTip(event, 'fs19', 39)" class="i">matches</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs22', 40)" onmouseover="showTip(event, 'fs22', 40)" class="i">m</span><span class="o">.</span><span class="i">Value</span> }
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 41)" onmouseover="showTip(event, 'fs9', 41)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 42)" onmouseover="showTip(event, 'fs23', 42)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs24', 43)" onmouseover="showTip(event, 'fs24', 43)" class="i">name</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs24', 44)" onmouseover="showTip(event, 'fs24', 44)" class="i">name</span><span class="o">.</span><span class="i">Trim</span>([|<span class="s">&#39; &#39;</span>; <span class="s">&#39;:&#39;</span>|]))
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 45)" onmouseover="showTip(event, 'fs25', 45)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 46)" onmouseover="showTip(event, 'fs26', 46)" class="i">ofSeq</span>
    <span onmouseout="hideTip(event, 'fs20', 47)" onmouseover="showTip(event, 'fs20', 47)" class="i">names</span>

<span class="c">// B) Extract names of characters in the format &quot;&lt;b&gt; [name] &lt;/b&gt;&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">getFormat2Names</span> <span onmouseout="hideTip(event, 'fs18', 49)" onmouseover="showTip(event, 'fs18', 49)" class="i">text</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 50)" onmouseover="showTip(event, 'fs22', 50)" class="i">m</span> <span class="o">=</span> <span class="i">Regex</span><span class="o">.</span><span class="i">Match</span>(<span onmouseout="hideTip(event, 'fs18', 51)" onmouseover="showTip(event, 'fs18', 51)" class="i">text</span>, <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">b</span><span class="s">&gt;</span><span class="s">[</span><span class="s"> </span><span class="s">]</span><span class="s">*</span><span class="s">[</span><span class="s">/</span><span class="s">A</span><span class="s">-</span><span class="s">Z0</span><span class="s">-</span><span class="s">9</span><span class="s"> </span><span class="s">-</span><span class="s">]</span><span class="s">+</span><span class="s">[</span><span class="s"> </span><span class="s">]</span><span class="s">*</span><span class="s">&lt;</span><span class="s">/</span><span class="s">b</span><span class="s">&gt;</span><span class="s">&quot;</span>)
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs22', 52)" onmouseover="showTip(event, 'fs22', 52)" class="i">m</span><span class="o">.</span><span class="i">Success</span> <span class="k">then</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 53)" onmouseover="showTip(event, 'fs28', 53)" class="i">name</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs22', 54)" onmouseover="showTip(event, 'fs22', 54)" class="i">m</span><span class="o">.</span><span class="i">Value</span><span class="o">.</span><span class="i">Replace</span>(<span class="s">&quot;</span><span class="s">&lt;</span><span class="s">b</span><span class="s">&gt;</span><span class="s">&quot;</span>,<span class="s">&quot;</span><span class="s">&quot;</span>)<span class="o">.</span><span class="i">Replace</span>(<span class="s">&quot;</span><span class="s">&lt;</span><span class="s">/</span><span class="s">b</span><span class="s">&gt;</span><span class="s">&quot;</span>,<span class="s">&quot;</span><span class="s">&quot;</span>)<span class="o">.</span><span class="i">Trim</span>()
        [| <span onmouseout="hideTip(event, 'fs28', 55)" onmouseover="showTip(event, 'fs28', 55)" class="i">name</span> |]
    <span class="k">else</span> [||]</pre>
</td>
</tr>
</table>

<p>Each of the regular expressions matches not only capital letters, but also numbers, hypens, spaces and slashes.
All because the characters in Star Wars use names like "R2-D2" or even "FODE/BEED".</p>

<p>To actually extract the list of characters that appear across the films, I also had to take
into account the fact that many characters use multiple names. Senator Palpatine turns into 
Darth Sidious and then into The Emperor, Amidala disguises herself as Padme (or the other way around?). 
Because of this I manually put together a simple file <a href="https://github.com/evelinag/StarWars-social-network/blob/master/data/aliases.csv">aliases.csv</a> 
where I specified which names I consider to be the same. I used these as a mapping onto a unique
name for each character (except for Anakin and Darth Vader).</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 56)" onmouseover="showTip(event, 'fs29', 56)" class="i">aliasFile</span> <span class="o">=</span> <span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">/</span><span class="s">data</span><span class="s">/</span><span class="s">aliases</span><span class="s">.</span><span class="s">csv</span><span class="s">&quot;</span>
<span class="c">// Use csv type provider to access the csv file with aliases</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs30', 57)" onmouseover="showTip(event, 'fs30', 57)" class="i">Aliases</span> <span class="o">=</span> <span class="i">CsvProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs29', 58)" onmouseover="showTip(event, 'fs29', 58)" class="i">aliasFile</span><span class="o">&gt;</span>

<span class="c">/// Dictionary for translating character names between aliases</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 59)" onmouseover="showTip(event, 'fs31', 59)" class="i">aliasDict</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs30', 60)" onmouseover="showTip(event, 'fs30', 60)" class="i">Aliases</span><span class="o">.</span><span class="i">Load</span>(<span onmouseout="hideTip(event, 'fs29', 61)" onmouseover="showTip(event, 'fs29', 61)" class="i">aliasFile</span>)<span class="o">.</span><span class="i">Rows</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 62)" onmouseover="showTip(event, 'fs9', 62)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 63)" onmouseover="showTip(event, 'fs23', 63)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs32', 64)" onmouseover="showTip(event, 'fs32', 64)" class="i">row</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs32', 65)" onmouseover="showTip(event, 'fs32', 65)" class="i">row</span><span class="o">.</span><span class="i">Alias</span>, <span onmouseout="hideTip(event, 'fs32', 66)" onmouseover="showTip(event, 'fs32', 66)" class="i">row</span><span class="o">.</span><span class="i">Name</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs33', 67)" onmouseover="showTip(event, 'fs33', 67)" class="i">dict</span>

<span class="c">/// Map character names onto unique set of names</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 68)" onmouseover="showTip(event, 'fs34', 68)" class="i">mapName</span> <span onmouseout="hideTip(event, 'fs24', 69)" onmouseover="showTip(event, 'fs24', 69)" class="i">name</span> <span class="o">=</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs31', 70)" onmouseover="showTip(event, 'fs31', 70)" class="i">aliasDict</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 71)" onmouseover="showTip(event, 'fs35', 71)" class="i">ContainsKey</span>(<span onmouseout="hideTip(event, 'fs24', 72)" onmouseover="showTip(event, 'fs24', 72)" class="i">name</span>) <span class="k">then</span> <span onmouseout="hideTip(event, 'fs31', 73)" onmouseover="showTip(event, 'fs31', 73)" class="i">aliasDict</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs24', 74)" onmouseover="showTip(event, 'fs24', 74)" class="i">name</span>] <span class="k">else</span> <span onmouseout="hideTip(event, 'fs24', 75)" onmouseover="showTip(event, 'fs24', 75)" class="i">name</span>

<span class="c">/// Extract character names from the given scene</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 76)" onmouseover="showTip(event, 'fs36', 76)" class="i">getCharacterNames</span> (<span onmouseout="hideTip(event, 'fs37', 77)" onmouseover="showTip(event, 'fs37', 77)" class="i">scene</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 78)" onmouseover="showTip(event, 'fs5', 78)" class="i">string</span> []) <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs38', 79)" onmouseover="showTip(event, 'fs38', 79)" class="i">names1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 80)" onmouseover="showTip(event, 'fs37', 80)" class="i">scene</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 81)" onmouseover="showTip(event, 'fs9', 81)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 82)" onmouseover="showTip(event, 'fs39', 82)" class="i">collect</span> <span onmouseout="hideTip(event, 'fs17', 83)" onmouseover="showTip(event, 'fs17', 83)" class="i">getFormat1Names</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 84)" onmouseover="showTip(event, 'fs40', 84)" class="i">names2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 85)" onmouseover="showTip(event, 'fs37', 85)" class="i">scene</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 86)" onmouseover="showTip(event, 'fs9', 86)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 87)" onmouseover="showTip(event, 'fs39', 87)" class="i">collect</span> <span onmouseout="hideTip(event, 'fs27', 88)" onmouseover="showTip(event, 'fs27', 88)" class="i">getFormat2Names</span> 
    <span onmouseout="hideTip(event, 'fs9', 89)" onmouseover="showTip(event, 'fs9', 89)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 90)" onmouseover="showTip(event, 'fs41', 90)" class="i">append</span> <span onmouseout="hideTip(event, 'fs38', 91)" onmouseover="showTip(event, 'fs38', 91)" class="i">names1</span> <span onmouseout="hideTip(event, 'fs40', 92)" onmouseover="showTip(event, 'fs40', 92)" class="i">names2</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 93)" onmouseover="showTip(event, 'fs9', 93)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 94)" onmouseover="showTip(event, 'fs23', 94)" class="i">map</span> <span onmouseout="hideTip(event, 'fs34', 95)" onmouseover="showTip(event, 'fs34', 95)" class="i">mapName</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 96)" onmouseover="showTip(event, 'fs9', 96)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 97)" onmouseover="showTip(event, 'fs42', 97)" class="i">distinct</span></pre>
</td>
</tr>
</table>

<p>Now I could finally extract names of characters from the individual scenes! The following
function extracts all the names of characters from all the screenplay urls.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 98)" onmouseover="showTip(event, 'fs43', 98)" class="i">allNames</span> <span class="o">=</span>
  <span class="i">scriptUrls</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 99)" onmouseover="showTip(event, 'fs44', 99)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 100)" onmouseover="showTip(event, 'fs45', 100)" class="i">map</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs46', 101)" onmouseover="showTip(event, 'fs46', 101)" class="i">episode</span>, <span onmouseout="hideTip(event, 'fs47', 102)" onmouseover="showTip(event, 'fs47', 102)" class="i">url</span>) <span class="k">-&gt;</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs48', 103)" onmouseover="showTip(event, 'fs48', 103)" class="i">script</span> <span class="o">=</span> <span class="i">getScript</span> <span onmouseout="hideTip(event, 'fs47', 104)" onmouseover="showTip(event, 'fs47', 104)" class="i">url</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs49', 105)" onmouseover="showTip(event, 'fs49', 105)" class="i">scriptParts</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs48', 106)" onmouseover="showTip(event, 'fs48', 106)" class="i">script</span><span class="o">.</span><span class="i">Elements</span>()

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs50', 107)" onmouseover="showTip(event, 'fs50', 107)" class="i">mainScript</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs49', 108)" onmouseover="showTip(event, 'fs49', 108)" class="i">scriptParts</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 109)" onmouseover="showTip(event, 'fs9', 109)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 110)" onmouseover="showTip(event, 'fs23', 110)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs51', 111)" onmouseover="showTip(event, 'fs51', 111)" class="i">element</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs51', 112)" onmouseover="showTip(event, 'fs51', 112)" class="i">element</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs52', 113)" onmouseover="showTip(event, 'fs52', 113)" class="i">ToString</span>())
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 114)" onmouseover="showTip(event, 'fs9', 114)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 115)" onmouseover="showTip(event, 'fs53', 115)" class="i">toArray</span>

    <span class="c">// Now every element of the list is a single scene</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 116)" onmouseover="showTip(event, 'fs6', 116)" class="i">scenes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 117)" onmouseover="showTip(event, 'fs3', 117)" class="i">splitByScene</span> <span onmouseout="hideTip(event, 'fs50', 118)" onmouseover="showTip(event, 'fs50', 118)" class="i">mainScript</span> [] 

    <span class="c">// Extract names appearing in each scene</span>
    <span onmouseout="hideTip(event, 'fs6', 119)" onmouseover="showTip(event, 'fs6', 119)" class="i">scenes</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 120)" onmouseover="showTip(event, 'fs44', 120)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 121)" onmouseover="showTip(event, 'fs45', 121)" class="i">map</span> <span onmouseout="hideTip(event, 'fs36', 122)" onmouseover="showTip(event, 'fs36', 122)" class="i">getCharacterNames</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 123)" onmouseover="showTip(event, 'fs25', 123)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 124)" onmouseover="showTip(event, 'fs54', 124)" class="i">concat</span> )
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 125)" onmouseover="showTip(event, 'fs25', 125)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 126)" onmouseover="showTip(event, 'fs54', 126)" class="i">concat</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 127)" onmouseover="showTip(event, 'fs9', 127)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 128)" onmouseover="showTip(event, 'fs55', 128)" class="i">countBy</span> <span onmouseout="hideTip(event, 'fs56', 129)" onmouseover="showTip(event, 'fs56', 129)" class="i">id</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 130)" onmouseover="showTip(event, 'fs9', 130)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 131)" onmouseover="showTip(event, 'fs57', 131)" class="i">filter</span> (<span onmouseout="hideTip(event, 'fs58', 132)" onmouseover="showTip(event, 'fs58', 132)" class="i">snd</span> <span class="o">&gt;</span><span class="o">&gt;</span> (<span class="o">&lt;</span>) <span class="n">1</span>)  <span class="c">// filter out characters that speak in only one scene</span></pre>
</td>
</tr>
</table>

<p>The only remaining problem was that many of the names were not actual names. The list was full
of people called "PILOT" or "OFFICER" or "CAPTAIN". After this I manually went through the
results and filtered out the names that were actual names. This resulted in the <a href="https://github.com/evelinag/StarWars-social-network/blob/master/data/characters.csv">characters.csv</a> file.</p>

<h2>Interactions between characters</h2>

<p>To construct the social networks, I wanted to extract all the occasions when two characters talk to each other. 
This happens if two characters speak within the same scene (I decided to ignore situations when people
talk with each other over a transmitter, and therefore across scenes). Extracting characters that are 
part of the same dialogue was now similified because I could just look at the list of characters I put together
in the previous step.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs59', 133)" onmouseover="showTip(event, 'fs59', 133)" class="i">characters</span> <span class="o">=</span> 
    <span class="i">File</span><span class="o">.</span><span class="i">ReadAllLines</span>(<span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">/</span><span class="s">data</span><span class="s">/</span><span class="s">characters</span><span class="s">.</span><span class="s">csv</span><span class="s">&quot;</span>) 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 134)" onmouseover="showTip(event, 'fs25', 134)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 135)" onmouseover="showTip(event, 'fs60', 135)" class="i">append</span> (<span onmouseout="hideTip(event, 'fs9', 136)" onmouseover="showTip(event, 'fs9', 136)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 137)" onmouseover="showTip(event, 'fs41', 137)" class="i">append</span> <span onmouseout="hideTip(event, 'fs31', 138)" onmouseover="showTip(event, 'fs31', 138)" class="i">aliasDict</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 139)" onmouseover="showTip(event, 'fs61', 139)" class="i">Keys</span> <span onmouseout="hideTip(event, 'fs31', 140)" onmouseover="showTip(event, 'fs31', 140)" class="i">aliasDict</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 141)" onmouseover="showTip(event, 'fs62', 141)" class="i">Values</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 142)" onmouseover="showTip(event, 'fs25', 142)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 143)" onmouseover="showTip(event, 'fs26', 143)" class="i">ofSeq</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs63', 144)" onmouseover="showTip(event, 'fs63', 144)" class="i">set</span></pre>
</td>
</tr>
</table>

<p>Here I created a set of all character names and their aliases to use for lookup and filtering. 
Then I used it to search through the characters appearing in each scene:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 145)" onmouseover="showTip(event, 'fs64', 145)" class="i">scenes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 146)" onmouseover="showTip(event, 'fs3', 146)" class="i">splitByScene</span> <span class="i">mainScript</span> [] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 147)" onmouseover="showTip(event, 'fs44', 147)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 148)" onmouseover="showTip(event, 'fs65', 148)" class="i">rev</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs66', 149)" onmouseover="showTip(event, 'fs66', 149)" class="i">namesInScenes</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs64', 150)" onmouseover="showTip(event, 'fs64', 150)" class="i">scenes</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 151)" onmouseover="showTip(event, 'fs44', 151)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 152)" onmouseover="showTip(event, 'fs45', 152)" class="i">map</span> <span onmouseout="hideTip(event, 'fs36', 153)" onmouseover="showTip(event, 'fs36', 153)" class="i">getCharacterNames</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 154)" onmouseover="showTip(event, 'fs44', 154)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 155)" onmouseover="showTip(event, 'fs45', 155)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs67', 156)" onmouseover="showTip(event, 'fs67', 156)" class="i">names</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs67', 157)" onmouseover="showTip(event, 'fs67', 157)" class="i">names</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 158)" onmouseover="showTip(event, 'fs25', 158)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 159)" onmouseover="showTip(event, 'fs68', 159)" class="i">filter</span> (<span class="k">fun</span> <span class="i">n</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs59', 160)" onmouseover="showTip(event, 'fs59', 160)" class="i">characters</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 161)" onmouseover="showTip(event, 'fs69', 161)" class="i">Contains</span> <span class="i">n</span>))       </pre>
</td>
</tr>
</table>

<p>Then I used the filtered list of characters to define the social network:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Create weighted network</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 162)" onmouseover="showTip(event, 'fs70', 162)" class="i">nodes</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs66', 163)" onmouseover="showTip(event, 'fs66', 163)" class="i">namesInScenes</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 164)" onmouseover="showTip(event, 'fs9', 164)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 165)" onmouseover="showTip(event, 'fs39', 165)" class="i">collect</span> <span onmouseout="hideTip(event, 'fs56', 166)" onmouseover="showTip(event, 'fs56', 166)" class="i">id</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 167)" onmouseover="showTip(event, 'fs9', 167)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 168)" onmouseover="showTip(event, 'fs55', 168)" class="i">countBy</span> <span onmouseout="hideTip(event, 'fs56', 169)" onmouseover="showTip(event, 'fs56', 169)" class="i">id</span>        
    <span class="c">// optional threshold on minimum number of mentions</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 170)" onmouseover="showTip(event, 'fs9', 170)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 171)" onmouseover="showTip(event, 'fs57', 171)" class="i">filter</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs71', 172)" onmouseover="showTip(event, 'fs71', 172)" class="i">name</span>, <span onmouseout="hideTip(event, 'fs72', 173)" onmouseover="showTip(event, 'fs72', 173)" class="i">count</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs72', 174)" onmouseover="showTip(event, 'fs72', 174)" class="i">count</span> <span class="o">&gt;</span><span class="o">=</span> <span class="i">countThreshold</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 175)" onmouseover="showTip(event, 'fs73', 175)" class="i">nodeLookup</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs70', 176)" onmouseover="showTip(event, 'fs70', 176)" class="i">nodes</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 177)" onmouseover="showTip(event, 'fs9', 177)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 178)" onmouseover="showTip(event, 'fs23', 178)" class="i">map</span> <span onmouseout="hideTip(event, 'fs74', 179)" onmouseover="showTip(event, 'fs74', 179)" class="i">fst</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs63', 180)" onmouseover="showTip(event, 'fs63', 180)" class="i">set</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs75', 181)" onmouseover="showTip(event, 'fs75', 181)" class="i">links</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs66', 182)" onmouseover="showTip(event, 'fs66', 182)" class="i">namesInScenes</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 183)" onmouseover="showTip(event, 'fs44', 183)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs76', 184)" onmouseover="showTip(event, 'fs76', 184)" class="i">collect</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs77', 185)" onmouseover="showTip(event, 'fs77', 185)" class="i">names</span> <span class="k">-&gt;</span> 
        [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs13', 186)" onmouseover="showTip(event, 'fs13', 186)" class="i">i</span> <span class="k">in</span> <span class="n">0..</span><span onmouseout="hideTip(event, 'fs77', 187)" onmouseover="showTip(event, 'fs77', 187)" class="i">names</span><span class="o">.</span><span class="i">Length</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span> 
            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs78', 188)" onmouseover="showTip(event, 'fs78', 188)" class="i">j</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs13', 189)" onmouseover="showTip(event, 'fs13', 189)" class="i">i</span><span class="o">+</span><span class="n">1..</span><span onmouseout="hideTip(event, 'fs77', 190)" onmouseover="showTip(event, 'fs77', 190)" class="i">names</span><span class="o">.</span><span class="i">Length</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
                <span class="k">let</span> <span onmouseout="hideTip(event, 'fs79', 191)" onmouseover="showTip(event, 'fs79', 191)" class="i">n1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 192)" onmouseover="showTip(event, 'fs77', 192)" class="i">names</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs13', 193)" onmouseover="showTip(event, 'fs13', 193)" class="i">i</span>]
                <span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 194)" onmouseover="showTip(event, 'fs80', 194)" class="i">n2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 195)" onmouseover="showTip(event, 'fs77', 195)" class="i">names</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs78', 196)" onmouseover="showTip(event, 'fs78', 196)" class="i">j</span>]
                <span class="k">if</span> <span onmouseout="hideTip(event, 'fs73', 197)" onmouseover="showTip(event, 'fs73', 197)" class="i">nodeLookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 198)" onmouseover="showTip(event, 'fs69', 198)" class="i">Contains</span>(<span onmouseout="hideTip(event, 'fs79', 199)" onmouseover="showTip(event, 'fs79', 199)" class="i">n1</span>) <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs73', 200)" onmouseover="showTip(event, 'fs73', 200)" class="i">nodeLookup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs69', 201)" onmouseover="showTip(event, 'fs69', 201)" class="i">Contains</span>(<span onmouseout="hideTip(event, 'fs80', 202)" onmouseover="showTip(event, 'fs80', 202)" class="i">n2</span>) <span class="k">then</span>
                    <span class="c">// order nodes alphabetically</span>
                    <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs81', 203)" onmouseover="showTip(event, 'fs81', 203)" class="i">min</span> <span onmouseout="hideTip(event, 'fs79', 204)" onmouseover="showTip(event, 'fs79', 204)" class="i">n1</span> <span onmouseout="hideTip(event, 'fs80', 205)" onmouseover="showTip(event, 'fs80', 205)" class="i">n2</span>, <span onmouseout="hideTip(event, 'fs82', 206)" onmouseover="showTip(event, 'fs82', 206)" class="i">max</span> <span onmouseout="hideTip(event, 'fs79', 207)" onmouseover="showTip(event, 'fs79', 207)" class="i">n1</span> <span onmouseout="hideTip(event, 'fs80', 208)" onmouseover="showTip(event, 'fs80', 208)" class="i">n2</span> ])
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 209)" onmouseover="showTip(event, 'fs9', 209)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 210)" onmouseover="showTip(event, 'fs55', 210)" class="i">countBy</span> <span onmouseout="hideTip(event, 'fs56', 211)" onmouseover="showTip(event, 'fs56', 211)" class="i">id</span></pre>
</td>
</tr>
</table>

<p>This gave me a list of nodes with the number of times they spoke across the whole script, which I used to 
specify the size of nodes in the visualizations. Then I created a link for each time two 
characters spoke within the same scene, and counted them to get the strength of each relationship.
Together, the <code>nodes</code> and <code>links</code> defined the full social network.</p>

<p>Finally, I exported the data into the JSON format. You can find all the networks, both the global
one and the individual episodes' networks, on <a href="https://github.com/evelinag/StarWars-social-network/tree/master/networks">my Github</a>.
The full code for this step is in the <a href="https://github.com/evelinag/StarWars-social-network/blob/master/getInteractions.fsx">getInteractions.fsx</a>
script.</p>

<h2>Character mentions in the script</h2>

<p>I also decided to look at where each of the characters appears throughout the six movie cycle, resulting
in the timelines chart. For this I looked at all the times the name of the character was 
mentioned in the scripts, not limited to the number of times the character actually spoke. 
The code for this was largerly similar to extracting the interactions in the previous section, 
only here I was looking for all the mentions and not only for the dialogues. 
To get the actual timelines, I also kept track of the scene numbers. The following code snippet
returns a list of scene numbers and characters that are mentioned in them.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 212)" onmouseover="showTip(event, 'fs6', 212)" class="i">scenes</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs3', 213)" onmouseover="showTip(event, 'fs3', 213)" class="i">splitByScene</span> <span class="i">mainScript</span> [] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 214)" onmouseover="showTip(event, 'fs44', 214)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs65', 215)" onmouseover="showTip(event, 'fs65', 215)" class="i">rev</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs83', 216)" onmouseover="showTip(event, 'fs83', 216)" class="i">totalScenes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 217)" onmouseover="showTip(event, 'fs6', 217)" class="i">scenes</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 218)" onmouseover="showTip(event, 'fs84', 218)" class="i">Length</span>

<span onmouseout="hideTip(event, 'fs6', 219)" onmouseover="showTip(event, 'fs6', 219)" class="i">scenes</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 220)" onmouseover="showTip(event, 'fs44', 220)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs85', 221)" onmouseover="showTip(event, 'fs85', 221)" class="i">mapi</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs86', 222)" onmouseover="showTip(event, 'fs86', 222)" class="i">sceneIdx</span> <span onmouseout="hideTip(event, 'fs37', 223)" onmouseover="showTip(event, 'fs37', 223)" class="i">scene</span> <span class="k">-&gt;</span> 
    <span class="c">// some names contain typos with lower-case characters</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs87', 224)" onmouseover="showTip(event, 'fs87', 224)" class="i">lscene</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 225)" onmouseover="showTip(event, 'fs37', 225)" class="i">scene</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 226)" onmouseover="showTip(event, 'fs25', 226)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs88', 227)" onmouseover="showTip(event, 'fs88', 227)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs89', 228)" onmouseover="showTip(event, 'fs89', 228)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs89', 229)" onmouseover="showTip(event, 'fs89', 229)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 230)" onmouseover="showTip(event, 'fs90', 230)" class="i">ToLower</span>()) 

    <span onmouseout="hideTip(event, 'fs59', 231)" onmouseover="showTip(event, 'fs59', 231)" class="i">characters</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 232)" onmouseover="showTip(event, 'fs25', 232)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs88', 233)" onmouseover="showTip(event, 'fs88', 233)" class="i">map</span> (<span class="k">fun</span> <span class="i">name</span> <span class="k">-&gt;</span> 
        <span onmouseout="hideTip(event, 'fs87', 234)" onmouseover="showTip(event, 'fs87', 234)" class="i">lscene</span> 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 235)" onmouseover="showTip(event, 'fs25', 235)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs88', 236)" onmouseover="showTip(event, 'fs88', 236)" class="i">map</span> (<span class="k">fun</span> <span class="i">contents</span> <span class="k">-&gt;</span> <span class="k">if</span> <span class="i">containsName</span> <span class="i">contents</span> <span class="i">name</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs12', 237)" onmouseover="showTip(event, 'fs12', 237)" class="i">Some</span> <span class="i">name</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs16', 238)" onmouseover="showTip(event, 'fs16', 238)" class="i">None</span> )
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 239)" onmouseover="showTip(event, 'fs25', 239)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 240)" onmouseover="showTip(event, 'fs91', 240)" class="i">choose</span> <span onmouseout="hideTip(event, 'fs56', 241)" onmouseover="showTip(event, 'fs56', 241)" class="i">id</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 242)" onmouseover="showTip(event, 'fs25', 242)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs54', 243)" onmouseover="showTip(event, 'fs54', 243)" class="i">concat</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 244)" onmouseover="showTip(event, 'fs25', 244)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs88', 245)" onmouseover="showTip(event, 'fs88', 245)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs24', 246)" onmouseover="showTip(event, 'fs24', 246)" class="i">name</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 247)" onmouseover="showTip(event, 'fs34', 247)" class="i">mapName</span> (<span onmouseout="hideTip(event, 'fs24', 248)" onmouseover="showTip(event, 'fs24', 248)" class="i">name</span><span class="o">.</span><span class="i">ToUpper</span>()))
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 249)" onmouseover="showTip(event, 'fs9', 249)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 250)" onmouseover="showTip(event, 'fs42', 250)" class="i">distinct</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 251)" onmouseover="showTip(event, 'fs9', 251)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 252)" onmouseover="showTip(event, 'fs23', 252)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs24', 253)" onmouseover="showTip(event, 'fs24', 253)" class="i">name</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs86', 254)" onmouseover="showTip(event, 'fs86', 254)" class="i">sceneIdx</span>, <span onmouseout="hideTip(event, 'fs24', 255)" onmouseover="showTip(event, 'fs24', 255)" class="i">name</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 256)" onmouseover="showTip(event, 'fs44', 256)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs92', 257)" onmouseover="showTip(event, 'fs92', 257)" class="i">ofSeq</span>)
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 258)" onmouseover="showTip(event, 'fs44', 258)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs76', 259)" onmouseover="showTip(event, 'fs76', 259)" class="i">collect</span> <span onmouseout="hideTip(event, 'fs56', 260)" onmouseover="showTip(event, 'fs56', 260)" class="i">id</span>,
<span onmouseout="hideTip(event, 'fs83', 261)" onmouseover="showTip(event, 'fs83', 261)" class="i">totalScenes</span></pre>
</td>
</tr>
</table>

<p>To get the full timeline, I used the scene numbers to map each episode into a 
<span class="math">\([ \text{episode index} - 1,\text{episode index}]\)</span> 
interval, giving me a relative scale of where in the episode the character appeared. 
The scene times in intervals [0,1] are from Episode I, in [1,2] correspond to Episode II etc.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// extract timelines</span>
[<span class="n">0</span> <span class="o">..</span> <span class="n">5</span>]
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 262)" onmouseover="showTip(event, 'fs44', 262)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 263)" onmouseover="showTip(event, 'fs45', 263)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs93', 264)" onmouseover="showTip(event, 'fs93', 264)" class="i">episodeIdx</span> <span class="k">-&gt;</span> <span class="i">getSceneAppearances</span> <span onmouseout="hideTip(event, 'fs93', 265)" onmouseover="showTip(event, 'fs93', 265)" class="i">episodeIdx</span>)
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 266)" onmouseover="showTip(event, 'fs44', 266)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs85', 267)" onmouseover="showTip(event, 'fs85', 267)" class="i">mapi</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs93', 268)" onmouseover="showTip(event, 'fs93', 268)" class="i">episodeIdx</span> (<span onmouseout="hideTip(event, 'fs94', 269)" onmouseover="showTip(event, 'fs94', 269)" class="i">sceneAppearances</span>, <span onmouseout="hideTip(event, 'fs95', 270)" onmouseover="showTip(event, 'fs95', 270)" class="i">total</span>) <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs94', 271)" onmouseover="showTip(event, 'fs94', 271)" class="i">sceneAppearances</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs44', 272)" onmouseover="showTip(event, 'fs44', 272)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 273)" onmouseover="showTip(event, 'fs45', 273)" class="i">map</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs96', 274)" onmouseover="showTip(event, 'fs96', 274)" class="i">scene</span>, <span onmouseout="hideTip(event, 'fs24', 275)" onmouseover="showTip(event, 'fs24', 275)" class="i">name</span>) <span class="k">-&gt;</span> 
        <span onmouseout="hideTip(event, 'fs97', 276)" onmouseover="showTip(event, 'fs97', 276)" class="i">float</span> <span onmouseout="hideTip(event, 'fs93', 277)" onmouseover="showTip(event, 'fs93', 277)" class="i">episodeIdx</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs97', 278)" onmouseover="showTip(event, 'fs97', 278)" class="i">float</span> <span onmouseout="hideTip(event, 'fs96', 279)" onmouseover="showTip(event, 'fs96', 279)" class="i">scene</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs97', 280)" onmouseover="showTip(event, 'fs97', 280)" class="i">float</span> <span onmouseout="hideTip(event, 'fs95', 281)" onmouseover="showTip(event, 'fs95', 281)" class="i">total</span>, <span onmouseout="hideTip(event, 'fs24', 282)" onmouseover="showTip(event, 'fs24', 282)" class="i">name</span>))      </pre>
</td>
</tr>
</table>

<p>I saved this data into an <a href="https://github.com/evelinag/StarWars-social-network/blob/master/data/charactersPerScene.csv">ill-formated pseudo-csv file</a>, 
where each row contains a character name and the relative times the character appeared across the 6 films,
separated by commas.<br />
The full code is in the
<a href="https://github.com/evelinag/StarWars-social-network/blob/master/getMentions.fsx">getMentions.fsx</a> file.</p>

<h2>Adding non-speaking characters</h2>

<p>When I compared the interactions and the characters that were mentioned in the scripts, 
I noticed that something was different: there was no R2-D2 and no Chewbacca. Not only
the poor Wookiee didn't receive any medal at the end of Episode IV (like the human heroes did), 
but he was missing from all the dialogues in the screenplays! Actually, both Chewbacca and 
R2-D2 appear throughout the scripts as non-speaking characters. They are mentioned in lines like</p>

<blockquote>
  <p>Artoo finds something that makes him whistle wildly.</p>
</blockquote>

<p>or</p>

<blockquote>
  <p>A sudden frown crosses Chewbacca's face and he begins yelling gibberish at the tiny robot.</p>
</blockquote>

<p>It wouldn't be a proper Star Wars social network if we ignored these two important characters. To 
correct for the racial discrimination against Wookiees and astromech droids, I decided to insert them 
into the social network defined by dialogues.</p>

<p>I looked again at all the times these
characters got mentioned in the screenplay. The mentions also define a social network where two 
characters are linked together if they are mentioned in the same scene. Because the characters
are included in the scene descriptions and they also talk about each other more than they actually
appear on screen, the network defined by all mentions is much messier than the network defined
by direct interactions. Because of this, I couldn't use the Chewbacca's and R2-D2's connections
directly in the social network. I could however use it as an approximation.</p>

<p>I extracted the node sizes and links for the two missing characters from the network 
defined by mentions. To transform them into connections from the social network,
I decided to scale all their values by
comparing them with similar characters. For this, I chose C-3PO as a proxy for R2-D2, and Han 
as a proxy for Chewie, assuming their interactions were largely similar. 
Then I applied the following formula to compute the link strengths in the 
dialogue social network (this example uses Chewbacca and Han):</p>

<p><span class="math">\[w_{\text{Han}} = \frac{1}{N} \sum_{x} \frac{\text{link weight}_{\text{dialogues}}(\text{Han}, x)}{\text{link weight}_{\text{mentions}}(\text{Han}, x)} \]</span></p>

<p><span class="math">\[\text{link weight}_{\text{dialogues}}(\text{Chewie}, x) = w_{\text{Han}} \times \text{link weight}_{\text{mentions}}(\text{Chewie}, x)\]</span></p>

<p>I used this highly scientific equation to recompute all the link strenghts and also the node
sizes. The weight factor was around 0.5 both for Han and C-3PO, which means the characters
were on average mentioned two times more than they actually spoke in the films. After this, I discarded
all the links that had their weight smaller than one. 
The <a href="https://github.com/evelinag/StarWars-social-network/blob/master/getInteractions.fsx">code for this step</a> 
is relatively long but not very interesting.</p>

<h2>Visualizations</h2>

<p>After manually adding back Chewbacca and R2-D2, I finally had the full set of social networks both for the
individual movies and for the full franchise. I used the <em>Force</em> to visualize the networks... well, I 
actually used the <a href="http://bl.ocks.org/mbostock/4062045"><em>force</em>-directed network layout</a>
from the <a href="http://d3js.org/">D3.js</a> library. 
This visualization method
uses a physical simulation of charged particles to generate a network layout. The most important part
of the D3 JavaScript file is the following part:</p>

<pre lang="javascript">d3.json(<span class="s">"starwars-episode-1-interactions-allCharacters.json"</span>, <span class="k">function</span>(error, graph) {
  <span class="c">/* More code here */</span>
  <span class="k">var</span> link = svg.selectAll(<span class="s">".link"</span>)
      .data(graph.links)
    .enter().append(<span class="s">"line"</span>)
      .attr(<span class="s">"class"</span>, <span class="s">"link"</span>)
      .style(<span class="s">"stroke-width"</span>, <span class="k">function</span>(d) { <span class="k">return</span> Math.sqrt(d.value); });

  <span class="k">var</span> node = svg.selectAll(<span class="s">".node"</span>)
      .data(graph.nodes)
    .enter().append(<span class="s">"circle"</span>)
      .attr(<span class="s">"class"</span>, <span class="s">"node"</span>)
      .attr(<span class="s">"r"</span>, 5)
      .style(<span class="s">"fill"</span>, <span class="k">function</span> (d) { <span class="k">return</span> d.colour; })
      .attr(<span class="s">"r"</span>, <span class="k">function</span> (d) { <span class="k">return</span> 2*Math.sqrt(d.value) + 2; })
      .call(force.drag);
  <span class="c">/* More code here */</span>
});</pre>

<p>In the previous steps I saved all the networks in JSON. Here I loaded them and defined the nodes and
links using the data from the JSON. For each node, I also added a colour for each node, and a <code>value</code> specifying
the importance (given by the number of times the character spoke in the script). This defines
the radius <code>r</code> attribute for the node object, scaling each node realative to its importance in the network. 
Similarly for the links, I also stored the strength of each link in the JSON file, and here I used it to 
define the <code>stroke-width</code> of each link.</p>

<h2>Centrality analysis</h2>

<p>As the final step, the analysis of centrality of individual characters was probably the simplest one. 
I used the <a href="http://bluemountaincapital.github.io/FSharpRProvider/">RProvider</a> together with the 
<a href="http://igraph.org/r/">igraph R package</a> to analyse the networks from F#. First I loaded the network
using the JSON type provider from FSharp.Data:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span class="i">RProvider</span><span class="o">.</span><span class="i">igraph</span>

<span class="k">let</span> [&lt;<span onmouseout="hideTip(event, 'fs98', 283)" onmouseover="showTip(event, 'fs98', 283)" class="i">Literal</span>&gt;] <span onmouseout="hideTip(event, 'fs99', 284)" onmouseover="showTip(event, 'fs99', 284)" class="i">linkFile</span> <span class="o">=</span> <span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">/</span><span class="s">networks</span><span class="s">/</span><span class="s">starwars</span><span class="s">-</span><span class="s">episode</span><span class="s">-</span><span class="s">1</span><span class="s">-</span><span class="s">interactions</span><span class="s">.</span><span class="s">json</span><span class="s">&quot;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs100', 285)" onmouseover="showTip(event, 'fs100', 285)" class="i">Network</span> <span class="o">=</span> <span class="i">JsonProvider</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs99', 286)" onmouseover="showTip(event, 'fs99', 286)" class="i">linkFile</span><span class="o">&gt;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs101', 287)" onmouseover="showTip(event, 'fs101', 287)" class="i">file</span> <span class="o">=</span> <span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;</span><span class="s">/</span><span class="s">networks</span><span class="s">/</span><span class="s">starwars</span><span class="s">-</span><span class="s">full</span><span class="s">-</span><span class="s">interactions</span><span class="s">-</span><span class="s">allCharacters</span><span class="s">.</span><span class="s">json</span><span class="s">&quot;</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs102', 288)" onmouseover="showTip(event, 'fs102', 288)" class="i">nodes</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 289)" onmouseover="showTip(event, 'fs100', 289)" class="i">Network</span><span class="o">.</span><span class="i">Load</span>(<span onmouseout="hideTip(event, 'fs101', 290)" onmouseover="showTip(event, 'fs101', 290)" class="i">file</span>)<span class="o">.</span><span class="i">Nodes</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 291)" onmouseover="showTip(event, 'fs9', 291)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 292)" onmouseover="showTip(event, 'fs23', 292)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs103', 293)" onmouseover="showTip(event, 'fs103', 293)" class="i">node</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs103', 294)" onmouseover="showTip(event, 'fs103', 294)" class="i">node</span><span class="o">.</span><span class="i">Name</span>) 
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs104', 295)" onmouseover="showTip(event, 'fs104', 295)" class="i">links</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 296)" onmouseover="showTip(event, 'fs100', 296)" class="i">Network</span><span class="o">.</span><span class="i">Load</span>(<span onmouseout="hideTip(event, 'fs101', 297)" onmouseover="showTip(event, 'fs101', 297)" class="i">file</span>)<span class="o">.</span><span class="i">Links</span></pre>
</td>
</tr>
</table>

<p>The <code>links</code> variable contains all the links in the network, where the end nodes are specified
by their indices. To simplify the interpretation of results, I mapped all the indices to the corresponding
character names:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs105', 298)" onmouseover="showTip(event, 'fs105', 298)" class="i">nodeLookup</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs102', 299)" onmouseover="showTip(event, 'fs102', 299)" class="i">nodes</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 300)" onmouseover="showTip(event, 'fs9', 300)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs106', 301)" onmouseover="showTip(event, 'fs106', 301)" class="i">mapi</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs13', 302)" onmouseover="showTip(event, 'fs13', 302)" class="i">i</span> <span onmouseout="hideTip(event, 'fs24', 303)" onmouseover="showTip(event, 'fs24', 303)" class="i">name</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs13', 304)" onmouseover="showTip(event, 'fs13', 304)" class="i">i</span>, <span onmouseout="hideTip(event, 'fs24', 305)" onmouseover="showTip(event, 'fs24', 305)" class="i">name</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs33', 306)" onmouseover="showTip(event, 'fs33', 306)" class="i">dict</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs107', 307)" onmouseover="showTip(event, 'fs107', 307)" class="i">edges</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs104', 308)" onmouseover="showTip(event, 'fs104', 308)" class="i">links</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 309)" onmouseover="showTip(event, 'fs25', 309)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs108', 310)" onmouseover="showTip(event, 'fs108', 310)" class="i">collect</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs109', 311)" onmouseover="showTip(event, 'fs109', 311)" class="i">link</span> <span class="k">-&gt;</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 312)" onmouseover="showTip(event, 'fs110', 312)" class="i">n1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs105', 313)" onmouseover="showTip(event, 'fs105', 313)" class="i">nodeLookup</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs109', 314)" onmouseover="showTip(event, 'fs109', 314)" class="i">link</span><span class="o">.</span><span class="i">Source</span>]
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs111', 315)" onmouseover="showTip(event, 'fs111', 315)" class="i">n2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs105', 316)" onmouseover="showTip(event, 'fs105', 316)" class="i">nodeLookup</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs109', 317)" onmouseover="showTip(event, 'fs109', 317)" class="i">link</span><span class="o">.</span><span class="i">Target</span>]
        [| <span onmouseout="hideTip(event, 'fs110', 318)" onmouseover="showTip(event, 'fs110', 318)" class="i">n1</span> ; <span onmouseout="hideTip(event, 'fs111', 319)" onmouseover="showTip(event, 'fs111', 319)" class="i">n2</span> |] )</pre>
</td>
</tr>
</table>

<p>Then I created an undirected graph object using the <code>igraph</code> library:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs112', 320)" onmouseover="showTip(event, 'fs112', 320)" class="i">graph</span> <span class="o">=</span>
    <span class="i">namedParams</span>[<span class="s">&quot;</span><span class="s">edges</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs113', 321)" onmouseover="showTip(event, 'fs113', 321)" class="i">box</span> <span onmouseout="hideTip(event, 'fs107', 322)" onmouseover="showTip(event, 'fs107', 322)" class="i">edges</span>; <span class="s">&quot;</span><span class="s">dir</span><span class="s">&quot;</span>, <span onmouseout="hideTip(event, 'fs113', 323)" onmouseover="showTip(event, 'fs113', 323)" class="i">box</span> <span class="s">&quot;</span><span class="s">undirected</span><span class="s">&quot;</span>]
    <span class="o">|&gt;</span> <span class="i">R</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 324)" onmouseover="showTip(event, 'fs112', 324)" class="i">graph</span></pre>
</td>
</tr>
</table>

<p>Calculating the betweenness and degree centrality was then as simple as</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs114', 325)" onmouseover="showTip(event, 'fs114', 325)" class="i">centrality</span> <span class="o">=</span> <span class="i">R</span><span class="o">.</span><span class="i">betweenness</span>(<span onmouseout="hideTip(event, 'fs112', 326)" onmouseover="showTip(event, 'fs112', 326)" class="i">graph</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs115', 327)" onmouseover="showTip(event, 'fs115', 327)" class="i">degreeCentrality</span> <span class="o">=</span> <span class="i">R</span><span class="o">.</span><span class="i">degree</span>(<span onmouseout="hideTip(event, 'fs112', 328)" onmouseover="showTip(event, 'fs112', 328)" class="i">graph</span>)</pre>
</td>
</tr>
</table>

<p>The full code that I used to produce the tables comparing the individual episodes is
available <a href="https://github.com/evelinag/StarWars-social-network/blob/master/centrality.fsx">here</a>.</p>

<h1>Summary</h1>

<p>As with most data science tasks, the most difficult step here was getting the data into
a good shape. The Star Wars screenplays all had slightly different
formats so I spent most of the time figuring out the
common properties of the HTML documents to create a common function for parsing them
and for identifying character names. 
 After that, it was just a little fight for Wookiee and droid equality
when I decided to combine data sources to infer their social connections. 
I made the extracted networks available <a href="https://github.com/evelinag/StarWars-social-network/tree/master/networks">in JSON on my GitHub</a>
so you can also play with them.</p>

<p>I hope you endjoyed the visualizations, and <em>may the force be with you</em>!</p>

<h2>Links</h2>

<ul>
<li>Source code: <a href="https://github.com/evelinag/StarWars-social-network">github.com/evelinag/StarWars-social-network</a></li>
<li>Extracted networks in JSON format: <a href="https://github.com/evelinag/StarWars-social-network/tree/master/networks">github.com/evelinag/StarWars-social-network/tree/master/networks</a></li>
<li>Screenplays: <a href="http://www.imsdb.com/">imsdb.com</a></li>
</ul>

<div class="tip" id="fs1">namespace Microsoft.FSharp.Data</div>
<div class="tip" id="fs2">val url : string<br /><br />Full name: starwarssocialnetwork.url</div>
<div class="tip" id="fs3">val splitByScene : script:string [] -&gt; scenes:string [] list -&gt; string [] list<br /><br />Full name: starwarssocialnetwork.splitByScene</div>
<div class="tip" id="fs4">val script : string []</div>
<div class="tip" id="fs5">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs6">val scenes : string [] list</div>
<div class="tip" id="fs7">val scenePattern : string</div>
<div class="tip" id="fs8">val idx : int option</div>
<div class="tip" id="fs9">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs10">val tryFindIndex : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; int option<br /><br />Full name: Microsoft.FSharp.Collections.Seq.tryFindIndex</div>
<div class="tip" id="fs11">val line : string</div>
<div class="tip" id="fs12">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs13">val i : int</div>
<div class="tip" id="fs14">val remainingScenes : string []</div>
<div class="tip" id="fs15">val currentScene : string []</div>
<div class="tip" id="fs16">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs17">val getFormat1Names : text:&#39;a -&gt; &#39;b []<br /><br />Full name: starwarssocialnetwork.getFormat1Names</div>
<div class="tip" id="fs18">val text : &#39;a</div>
<div class="tip" id="fs19">val matches : seq&lt;obj&gt;</div>
<div class="tip" id="fs20">val names : &#39;b []</div>
<div class="tip" id="fs21">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs22">val m : obj</div>
<div class="tip" id="fs23">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs24">val name : obj</div>
<div class="tip" id="fs25">module Array<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs26">val ofSeq : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.ofSeq</div>
<div class="tip" id="fs27">val getFormat2Names : text:&#39;a -&gt; &#39;b []<br /><br />Full name: starwarssocialnetwork.getFormat2Names</div>
<div class="tip" id="fs28">val name : &#39;b</div>
<div class="tip" id="fs29">val aliasFile : string<br /><br />Full name: starwarssocialnetwork.aliasFile</div>
<div class="tip" id="fs30">type Aliases = obj<br /><br />Full name: starwarssocialnetwork.Aliases</div>
<div class="tip" id="fs31">val aliasDict : System.Collections.Generic.IDictionary&lt;obj,obj&gt;<br /><br />Full name: starwarssocialnetwork.aliasDict<br /><em><br /><br />&#160;Dictionary for translating character names between aliases</em></div>
<div class="tip" id="fs32">val row : obj</div>
<div class="tip" id="fs33">val dict : keyValuePairs:seq&lt;&#39;Key * &#39;Value&gt; -&gt; System.Collections.Generic.IDictionary&lt;&#39;Key,&#39;Value&gt; (requires equality)<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.dict</div>
<div class="tip" id="fs34">val mapName : name:obj -&gt; obj<br /><br />Full name: starwarssocialnetwork.mapName<br /><em><br /><br />&#160;Map character names onto unique set of names</em></div>
<div class="tip" id="fs35">System.Collections.Generic.IDictionary.ContainsKey(key: obj) : bool</div>
<div class="tip" id="fs36">val getCharacterNames : scene:string [] -&gt; seq&lt;obj&gt;<br /><br />Full name: starwarssocialnetwork.getCharacterNames<br /><em><br /><br />&#160;Extract character names from the given scene</em></div>
<div class="tip" id="fs37">val scene : string []</div>
<div class="tip" id="fs38">val names1 : seq&lt;obj&gt;</div>
<div class="tip" id="fs39">val collect : mapping:(&#39;T -&gt; #seq&lt;&#39;U&gt;) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.collect</div>
<div class="tip" id="fs40">val names2 : seq&lt;obj&gt;</div>
<div class="tip" id="fs41">val append : source1:seq&lt;&#39;T&gt; -&gt; source2:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.append</div>
<div class="tip" id="fs42">val distinct : source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt; (requires equality)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.distinct</div>
<div class="tip" id="fs43">val allNames : seq&lt;obj * int&gt;<br /><br />Full name: starwarssocialnetwork.allNames</div>
<div class="tip" id="fs44">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs45">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs46">val episode : obj</div>
<div class="tip" id="fs47">val url : obj</div>
<div class="tip" id="fs48">val script : obj</div>
<div class="tip" id="fs49">val scriptParts : seq&lt;obj&gt;</div>
<div class="tip" id="fs50">val mainScript : string []</div>
<div class="tip" id="fs51">val element : obj</div>
<div class="tip" id="fs52">System.Object.ToString() : string</div>
<div class="tip" id="fs53">val toArray : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs54">val concat : arrays:seq&lt;&#39;T []&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.concat</div>
<div class="tip" id="fs55">val countBy : projection:(&#39;T -&gt; &#39;Key) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;Key * int&gt; (requires equality)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.countBy</div>
<div class="tip" id="fs56">val id : x:&#39;T -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.id</div>
<div class="tip" id="fs57">val filter : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.filter</div>
<div class="tip" id="fs58">val snd : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T2<br /><br />Full name: Microsoft.FSharp.Core.Operators.snd</div>
<div class="tip" id="fs59">val characters : Set&lt;obj&gt;<br /><br />Full name: starwarssocialnetwork.characters</div>
<div class="tip" id="fs60">val append : array1:&#39;T [] -&gt; array2:&#39;T [] -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.append</div>
<div class="tip" id="fs61">property System.Collections.Generic.IDictionary.Keys: System.Collections.Generic.ICollection&lt;obj&gt;</div>
<div class="tip" id="fs62">property System.Collections.Generic.IDictionary.Values: System.Collections.Generic.ICollection&lt;obj&gt;</div>
<div class="tip" id="fs63">val set : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt; (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.set</div>
<div class="tip" id="fs64">val scenes : string [] list<br /><br />Full name: starwarssocialnetwork.scenes</div>
<div class="tip" id="fs65">val rev : list:&#39;T list -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.rev</div>
<div class="tip" id="fs66">val namesInScenes : seq&lt;System.IComparable&gt; list<br /><br />Full name: starwarssocialnetwork.namesInScenes</div>
<div class="tip" id="fs67">val names : seq&lt;obj&gt;</div>
<div class="tip" id="fs68">val filter : predicate:(&#39;T -&gt; bool) -&gt; array:&#39;T [] -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.filter</div>
<div class="tip" id="fs69">member Set.Contains : value:&#39;T -&gt; bool</div>
<div class="tip" id="fs70">val nodes : seq&lt;System.IComparable * int&gt;<br /><br />Full name: starwarssocialnetwork.nodes</div>
<div class="tip" id="fs71">val name : System.IComparable</div>
<div class="tip" id="fs72">val count : int</div>
<div class="tip" id="fs73">val nodeLookup : Set&lt;System.IComparable&gt;<br /><br />Full name: starwarssocialnetwork.nodeLookup</div>
<div class="tip" id="fs74">val fst : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T1<br /><br />Full name: Microsoft.FSharp.Core.Operators.fst</div>
<div class="tip" id="fs75">val links : (int * obj) list * int<br /><br />Full name: starwarssocialnetwork.links</div>
<div class="tip" id="fs76">val collect : mapping:(&#39;T -&gt; &#39;U list) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.collect</div>
<div class="tip" id="fs77">val names : seq&lt;System.IComparable&gt;</div>
<div class="tip" id="fs78">val j : int</div>
<div class="tip" id="fs79">val n1 : System.IComparable</div>
<div class="tip" id="fs80">val n2 : System.IComparable</div>
<div class="tip" id="fs81">val min : e1:&#39;T -&gt; e2:&#39;T -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.Operators.min</div>
<div class="tip" id="fs82">val max : e1:&#39;T -&gt; e2:&#39;T -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.Operators.max</div>
<div class="tip" id="fs83">val totalScenes : int</div>
<div class="tip" id="fs84">property List.Length: int</div>
<div class="tip" id="fs85">val mapi : mapping:(int -&gt; &#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.mapi</div>
<div class="tip" id="fs86">val sceneIdx : int</div>
<div class="tip" id="fs87">val lscene : string []</div>
<div class="tip" id="fs88">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.map</div>
<div class="tip" id="fs89">val s : string</div>
<div class="tip" id="fs90">System.String.ToLower() : string<br />System.String.ToLower(culture: System.Globalization.CultureInfo) : string</div>
<div class="tip" id="fs91">val choose : chooser:(&#39;T -&gt; &#39;U option) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.choose</div>
<div class="tip" id="fs92">val ofSeq : source:seq&lt;&#39;T&gt; -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.ofSeq</div>
<div class="tip" id="fs93">val episodeIdx : int</div>
<div class="tip" id="fs94">val sceneAppearances : (int * obj) list</div>
<div class="tip" id="fs95">val total : int</div>
<div class="tip" id="fs96">val scene : int</div>
<div class="tip" id="fs97">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs98">Multiple items<br />type LiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; LiteralAttribute<br /><br />Full name: Microsoft.FSharp.Core.LiteralAttribute<br /><br />--------------------<br />new : unit -&gt; LiteralAttribute</div>
<div class="tip" id="fs99">val linkFile : string<br /><br />Full name: starwarssocialnetwork.linkFile</div>
<div class="tip" id="fs100">type Network = obj<br /><br />Full name: starwarssocialnetwork.Network</div>
<div class="tip" id="fs101">val file : string<br /><br />Full name: starwarssocialnetwork.file</div>
<div class="tip" id="fs102">val nodes : seq&lt;obj&gt;<br /><br />Full name: starwarssocialnetwork.nodes</div>
<div class="tip" id="fs103">val node : obj</div>
<div class="tip" id="fs104">val links : obj []<br /><br />Full name: starwarssocialnetwork.links</div>
<div class="tip" id="fs105">val nodeLookup : System.Collections.Generic.IDictionary&lt;int,obj&gt;<br /><br />Full name: starwarssocialnetwork.nodeLookup</div>
<div class="tip" id="fs106">val mapi : mapping:(int -&gt; &#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.mapi</div>
<div class="tip" id="fs107">val edges : obj []<br /><br />Full name: starwarssocialnetwork.edges</div>
<div class="tip" id="fs108">val collect : mapping:(&#39;T -&gt; &#39;U []) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.collect</div>
<div class="tip" id="fs109">val link : obj</div>
<div class="tip" id="fs110">val n1 : obj</div>
<div class="tip" id="fs111">val n2 : obj</div>
<div class="tip" id="fs112">val graph : obj<br /><br />Full name: starwarssocialnetwork.graph</div>
<div class="tip" id="fs113">val box : value:&#39;T -&gt; obj<br /><br />Full name: Microsoft.FSharp.Core.Operators.box</div>
<div class="tip" id="fs114">val centrality : obj<br /><br />Full name: starwarssocialnetwork.centrality</div>
<div class="tip" id="fs115">val degreeCentrality : obj<br /><br />Full name: starwarssocialnetwork.degreeCentrality</div>

</article>

<p class="post-meta">
    Published on Tuesday, 15 December 2015
    <br />
    By <a href="https://plus.google.com/+EvelinaGabasova?rel=author">Evelina Gabasova</a><br />
</p>

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style addthis_32x32_style">
    <a class="addthis_button_twitter"></a>
    <a class="addthis_button_reddit"></a>
    <a class="addthis_button_google_plusone_share"></a>
    <a class="addthis_button_facebook"></a>
    <a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<br />

<script type="text/javascript">var addthis_config = { "data_track_addressbar": true };</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-531bbb5c0879f9d7"></script>
<!-- AddThis Button END -->

<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'evelinag'; 
    var disqus_title = 'The Star Wars social network';
    var disqus_url = '';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<!-- Disqus END -->

        </div>
    </div>
    <!-- End Main Content and Sidebar -->
    <!-- Footer -->
    <footer class="footer">
        <div class="row full-width">
            <div class="small-12 medium-6 large-8 columns">
                <i class="fi-laptop"></i>
                <h4>About</h4>
                <p>
                    You can find more about me at
                    <a href="http://evelinag.com/about/index.html">my professional web page</a>.
                    It includes details on my
                    <a href="http://evelinag.com/about/index.html#publications">academic research</a>
                    and
                    <a href="http://evelinag.com/about/index.html#talks">talks</a> that I gave.
                    There is a list of
                    <a href="http://evelinag.com/about/index.html#fsharptalks">my F# talks</a>,
                    which contains several recordings that you can watch.
                    See also a list of
                    <a href="http://evelinag.com/about/index.html#projects">projects</a>
                    that I am involved in.
                </p>
                <p>
                    This site is generated using <a href="https://github.com/fsprojects/FsBlog">FsBlog</a> and hosted on <a href="http://github.com/evelinag">GitHub</a>.
                    <br />By <a href="https://plus.google.com/+EvelinaGabasova?rel=author">Evelina Gabasova</a>, 2015
                </p>
            </div>
            <div class="small-12 medium-6 large-4 columns">
                <h4 class="footer-links">Contact information</h4>
                <ul class="footer-links">
                    <li>Twitter: <a href="http://twitter.com/evelgab">@evelgab</a></li>
                    <li>Email: <a href="mailto:evelina@evelinag.com">evelina@evelinag.com</a></li>
                    <li>Github: <a href="http://github.com/evelinag">evelinag</a></li>
                    <li>LinkedIn: <a href="http://uk.linkedin.com/in/egabasova">egabasova</a></li>
                    <li>My talks on <a href="http://lanyrd.com/profile/evelgab/">Lanyrd</a></li>
                    <li>Subscribe to my <a href="http://evelinag.com/rss.xml">blog</a></li>
                </ul>
            </div>
        </div>
    </footer>


    <!-- End Footer -->
    <!-- Foundation scripts -->
    <script src="http://evelinag.com/javascripts/vendor/jquery.js"></script>
    <script src="http://evelinag.com/javascripts/foundation.min.js"></script>
    <script src="http://evelinag.com/javascripts/foundation/foundation.interchange.js"></script>
    <script>
        $(document).foundation();
    </script>
    <!-- End Foundation scripts -->

</body>

</htm>
